Initialization Properties (Advantage OLE DB Provider)




Advantage Database Server 12  

Initialization Properties

Advantage OLE DB Provider (for ADO)

|  |
| --- |
|  |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| Initialization Properties  Advantage OLE DB Provider (for ADO) |  |  | Feedback on: Advantage Database Server 12 - Initialization Properties Advantage OLE DB Provider (for ADO) oledb\_Initialization\_properties\_(advantage\_ole\_db\_provider) Advantage OLE DB Provider (for ADO) > Low Level OLE DB Information > Data Source Objects > Initialization Properties (Advantage OLE DB Provider) / Dear Support Staff, |  |
| Initialization Properties  Advantage OLE DB Provider (for ADO) |  |  |  |  |

The Advantage OLE DB Provider implements the following properties in the DBPROPSET\_DBINIT property set. All of these properties are in the Initialization property group.

|  |  |
| --- | --- |
| Property ID | Description |
| DBPROP\_AUTH\_PASSWORD | Type: VT\_BSTR  Typical R/W: Read/Write  Description: Password  Indicates the password to use in conjunction with the User ID (DBPROP\_AUTH\_USERID) when making a [Database Connection](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)) to an Advantage server. |
| DBPROP\_AUTH\_USERID | Type: VT\_BSTR  Typical R/W: Read/Write  Description: User ID  Indicates the user name to use when making a Database Connection to an Advantage server (see DBPROP\_INIT\_DATASOURCE). Note that if this property is supplied, Advantage assumes that a [Database Connection](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)) is being attempted. If a [Free Connection](javascript:hhpopuplink.TextPopup(popid_1940894724X,FontFace,-1,-1,-1,-1)) is desired, do not supply this property. |
| DBPROP\_INIT\_CATALOG | Type: VT\_BSTR  Typical R/W: Read/Write  Description: Initial Catalog  The name of the data dictionary to use when creating a [Database Connection](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)) to an Advantage server. It is not necessary to specify the initial catalog. The full path to the Advantage Data Dictionary can also be specified in the Data Source (DBPROP\_INIT\_DATASOURCE) property if desired. |
| DBPROP\_INIT\_DATASOURCE | Type: VT\_BSTR  Typical R/W: Read/Write  Description: Data Source  The fully qualified path to the computer where the data files exist and the default location of the data files. This fully qualified path must contain a drive letter or use UNC. The Data Source must be specified before a successful connection to an Advantage server can occur. If a [Free Connection](javascript:hhpopuplink.TextPopup(popid_1940894724X,FontFace,-1,-1,-1,-1)) is desired, the Data Source must specify a directory location. For a [Database Connection](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)), the path and data dictionary file can be specified in the Data Source property (e.g., Data Source=\\myserver\myvolume\mypat\mydd.add). Or the Data Source can contain just the path, and the Initial Catalog property (DBPROP\_INIT\_CATALOG) can contain the data dictionary name (e.g., Data Source=\\myserver\myvolume\mypath; Initial Catalog=mydd.add). |
| DBPROP\_INIT\_HWND | Type: VT\_I4  Typical R/W: Read/Write  Description: Window Handle  Indicates the window handle to be used if the data source object needs to prompt for additional information. Currently, the Advantage OLE DB Provider will never prompt the consumer for additional information. |
| DBPROP\_INIT\_MODE | Type: VT\_I4  Typical R/W: Read/Write  Description: Mode  A bitmask specifying access permissions. For the Advantage OLE DB Provider, the default value is DB\_MODE\_READWRITE | DB\_MODE\_SHARE\_DENY\_NONE.  If you are accessing a database on read-only media such as a CD-ROM, then you should set the DBPROP\_INIT\_MODE entry to DB\_MODE\_READ (ADODB.Mode = adModeRead in ADO), so that Advantage will not attempt to open the tables in read-write mode. Note that setting the mode to DB\_MODE\_READ does not affect UPDATE, INSERT, and DELETE statements. Those statements can still be executed on this connection. |
| DBPROP\_INIT\_PROMPT | Type: VT\_I2  Typical R/W: Read/Write  Description: Prompt  Indicates whether to prompt the user during initialization. The Advantage OLE DB Provider supports all prompting modes for data source initialization. The Advantage OLE DB Provider uses DBPROMPT\_NOPROMPT as its default setting for the property. |
| DBPROP\_INIT\_PROVIDERSTRING | Type: VT\_BSTR  Typical R/W: Read/Write  Description: Extended Properties  A string containing provider-specific, extended connection information. See the Advantage OLE DB Provider String later in this topic for more information on valid Provider String values. |
| DBPROP\_INIT\_TIMEOUT | Type: VT\_I4  Typical R/W: Read/Write  Description: Connect Timeout  Indicates the amount of time (in seconds) to wait for initialization to complete. The Advantage OLE DB Provider ignores this timeout setting. |

The Advantage OLE DB Provider String

The Advantage OLE DB Provider recognizes an ODBC-like syntax in provider string property values. The provider string property is provided as the value of the OLE DB initialization property DBPROP\_INIT\_PROVIDERSTRING when a connection is established to the OLE DB data source. This property specifies OLE DB provider-specific connection data required to implement a connection to the OLE DB data source. Within the string, elements are delimited by using a semicolon. The final element in the string must be terminated with a semicolon. Each element consists of a keyword, an equal sign character, and the value passed on initialization, as shown in the following example:

 

TableType=ADX\_CDX;SecurityMode=ADS\_IGNORERIGHTS;

 

With the Advantage OLE DB Provider, the consumer never needs to use the provider string property. The consumer can set any initialization property reflected in the provider string by using either OLE DBspecific or the Advantage OLE DB Provider-specific initialization properties.

The Advantage OLE DB Provider recognizes the following keywords in the provider string property.

|  |  |
| --- | --- |
| Property ID | Description |
| ADSPROP\_INIT\_CHAR\_TYPE | Keyword: CharType  Description: Specifies whether the data in DBF tables is ANSI or OEM. Valid values include ADS\_ANSI and ADS\_OEM. This setting is applicable to the ADS\_CDX, ADS\_VFP, and ADS\_NTX TableType options. The default is ADS\_ANSI. When using ADS\_ADT and ADS\_VFP tables, the value can also be one of the [dynamically loaded collations](master_collation_support.htm). |
| ADSPROP\_INIT\_ENCRYPTION\_PASSWORD | Keyword: EncryptionPassword  Description: Specifies the encryption password to use with all tables on [Free Connections](javascript:hhpopuplink.TextPopup(popid_1940894724X,FontFace,-1,-1,-1,-1)). The encryption password will consist of the first twenty characters specified. For [Database Connections](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)) (see DBPROP\_INIT\_DATASOURCE), this property is not used. [Database Connections](javascript:hhpopuplink.TextPopup(popid_2045887057,FontFace,-1,-1,-1,-1)) should use the User ID and Password properties (DBPROP\_AUTH\_USERID and DBPROP\_AUTH\_PASSWORD). |
| ADSPROP\_INIT\_FILTER\_OPTIONS | Keyword: FilterOptions  Description: Specifies whether to respect the filtering applied to the rowset when determining record count and logical positioning information. Valid values are IGNORE\_WHEN\_COUNTING and RESPECT\_WHEN\_COUNTING. When using RESPECT\_WHEN\_COUNTING, the record count and scroll bar positioning will be accurate but with a potential speed tradeoff. In some cases, the provider may have to skip through all records in the rowset to determine the count and position. It is not recommended to use this option except on very small rowsets. When a rowset is to be opened and displayed in a data bound grid, the grid requests record count information from the provider to position the scroll bar. Because it can request this information several times for any movement in the grid, it is usually best if the IGNORE\_WHEN\_COUNTING option is used in order for the grid to be more responsive. If you use the ADO RecordSet property .RecordCount and need a completely accurate count, then use the RESPECT\_WHEN\_COUNTING option. All record count requests are sent to the same OLE DB interface, so it is not possible for it to know implicitly how accurate the count should be for a given call. The default is IGNORE\_WHEN\_COUNTING. |
| ADSPROP\_INIT\_INCREMENT\_USERCOUNT | Keyword: IncrementUsercount  Description: Specifies whether to increment the user count on the Advantage Database Server even if the current PC is already connected. Valid values are TRUE and FALSE. With a value of FALSE, if the same PC connects to Advantage more than one time the connections are counted as a single user and only the connection count is incremented. With a value of TRUE, each connection counts as a new user on the Advantage Database Server. This property allows an Advantage middleware type of application to increment the Advantage Database Server user count for each remote client workstation indirectly accessing the Advantage Database Server. This provides an easy way for Advantage middleware applications to abide by the Advantage Database Server license agreement as related to remote client workstations taking up a "user" toward the maximum number of licensed users. The default is FALSE. |
| ADSPROP\_INIT\_LOCK\_MODE | Keyword: LockMode  Description: Specifies the locking mode to use with DBF tables. Valid values include ADS\_PROPRIETARY\_LOCKING and ADS\_COMPATIBLE\_LOCKING. This setting is applicable to the ADS\_CDX, ADS\_VFP, and ADS\_NTX TableType options. If set to ADS\_PROPRIETARY\_LOCKING, Advantages high-performance internal locking mode is used. If set to ADS\_COMPATIBLE\_LOCKING, DBF tables can be shared in a writable mode with non-Advantage database applications. The default is ADS\_PROPRIETARY\_LOCKING. |
| ADSPROP\_INIT\_SECURITY\_MODE | Keyword: SecurityMode  Description: Specifies the security mode to use. Valid values include ADS\_CHECKRIGHTS and ADS\_IGNORERIGHTS. The default is ADS\_CHECKRIGHTS.  Beginning with version 10.0, the client no longer performs rights checking by default. See [Check Rights](master_check_rights.htm). |
| ADSPROP\_INIT\_SERVER\_TYPE | Keyword: ServerType  Description: Specifies the Advantage server types to which connections should be attempted. Valid values include ADS\_REMOTE\_SERVER, ADS\_AIS\_SERVER, and ADS\_LOCAL\_SERVER. These values can be logically ORed together with the vertical bar character "|" in order to choose multiple server types. The default is ADS\_REMOTE\_SERVER | ADS\_AIS\_SERVER. If multiple types are specified and multiple server types are available, the order of precedence is ADS\_REMOTE\_SERVER first, ADS\_AIS\_SERVER second, and ADS\_LOCAL\_SERVER third. |
| ADSPROP\_INIT\_SHOW\_DELETED | Keyword: ShowDeleted  Description: Specifies whether deleted records in DBF tables are visible. Valid values are TRUE or FALSE. This setting is applicable to the ADS\_CDX, ADS\_VFP and ADS\_NTX TableType options. If set to TRUE, deleted records in the DBF table will be visible. The default is FALSE. |
| ADSPROP\_INIT\_TABLE\_TYPE | Keyword: TableType  Description: Specifies the desired table type. Valid values include ADS\_ADT, ADS\_CDX, ADS\_VFP, and ADS\_NTX. The default is ADS\_ADT. |
| ADSPROP\_INIT\_TRIM\_TRAILING\_SPACES | Keyword: TrimTrailingSpaces  Description: Specifies whether trailing white space is removed from string fields when the data is retrieved. Valid values are TRUE or FALSE. If TRUE is specified, then fields of type DBTYPE\_STR will have trailing white spaced trimmed on retrieval. Note that the Advantage data types ADS\_STRING and ADS\_MEMO are both mapped to DBTYPE\_STR. If FALSE is specified, then trailing white space is maintained on the values when they are retrieved. This means that a fixed length field (ADS\_STRING) with a width of 10, for example, will always return 10 characters when the value is retrieved; it is padded with as many spaces as necessary. It may be desirable to specify TRUE to trim trailing blanks if, for example, an application is using the ADO Find method. If trailing blanks are not trimmed, then search values given to the Find method would have to be padded to the full field length in order for the search to succeed. The default is FALSE. |
| ADSPROP\_INIT\_USE\_NULLS | Keyword: DbfsUseNulls  Description: Specifies whether DBF tables are to return NULL for column data that is ordinarily considered as "empty" in Xbase terminology. Valid values are TRUE or FALSE. This setting is applicable to the ADS\_CDX and ADS\_NTX TableType options. If set to TRUE, "empty" column values in DBF tables will be returned as NULL. If set to FALSE, "empty" column values in DBF tables will be returned as actual valid data. The default is FALSE. This does not apply to ADS\_VFP tables, which have true NULL value support. |
| ADSPROP\_INIT\_STORED\_PROCEDURE\_CONNECTION | Keyword: StoredProcedureConnection  Description: Specifies if this connection lives within a stored procedure executed on the behalf of remote clients. Valid values are TRUE and FALSE. If this property is set to TRUE, the application will not increment the server user count for the stored procedure. If it is FALSE, then the stored procedure will increment the server user count, which will prevent other users from connecting when the user count reaches the maximum. The default is FALSE. Connections to Advantage Local Server are not affected by this property. |
| ADSPROP\_INIT\_COMPRESSION | Keyword: Compression  Description: Specifies the option for [communications compression](master_communications_compression.htm). Valid values are INTERNET, ALWAYS, and NEVER. If INTERNET is specified, then all data communications for ADS\_AIS\_SERVER connections will be compressed unless compression is specifically turned off at the server. If ALWAYS is specified, then all data communications between the client and server will be compressed unless compression is specifically turned off at the server. If NEVER is specified, then compression will not be used for communications between the client and server. If this property is not specified, then the COMPRESSION setting in the ADS.INI file will be used if available. This property is ignored for ADS\_LOCAL\_SERVER connections. |