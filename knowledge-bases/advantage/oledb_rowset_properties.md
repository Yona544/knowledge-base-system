Rowset Properties




Advantage Database Server 12  

Rowset Properties

Advantage OLE DB Provider (for ADO)

|  |
| --- |
|  |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| Rowset Properties  Advantage OLE DB Provider (for ADO) |  |  | Feedback on: Advantage Database Server 12 - Rowset Properties Advantage OLE DB Provider (for ADO) oledb\_Rowset\_properties Advantage OLE DB Provider (for ADO) > Low Level OLE DB Information > Rowsets > Rowset Properties / Dear Support Staff, |  |
| Rowset Properties  Advantage OLE DB Provider (for ADO) |  |  |  |  |

The Advantage OLE DB Provider implements the following properties in the DBPROPSET\_ROWSET property set. All of these properties are in the Rowset property group.

|  |  |
| --- | --- |
| Property ID | Description |
| DBPROP\_ABORTPRESERVE | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The behavior of a rowset after an abort operation is determined by this property. With the Advantage OLE DB Provider, after aborting a transaction, the rowset remains active. That is, it is possible to fetch new rows, update, delete, and insert rows, and so on. |
| DBPROP\_ACCESSORDER | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_AO\_RANDOM  Description: Sets the order in which columns must be accessed on the rowset. For the Advantage OLE DB Provider, this value is always DBPROPVAL\_AO\_RANDOM meaning columns can be accessed in any order. |
| DBPROP\_BLOCKINGSTORAGEOBJECTS | Type: VT\_BOOL  Typical R/W: Read-only  Description: Blocking Storage Objects  Indicates whether storage objects might prevent use of other methods on the rowset. For the Advantage OLE DB Provider, this property is set to VARIANT\_FALSE meaning instantiated storage objects do not prevent the use of other methods. |
| DBPROP\_BOOKMARKINFO | Type: VT\_I4  Typical R/W: Read-only  Default: 0  Description: A bitmask specifying additional information about bookmarks over the rowset. For the Advantage OLE DB Provider, this value is always zero because bookmarks are not valid across rowsets. |
| DBPROP\_BOOKMARKS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: Indicates whether the rowset supports bookmarks. For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE for non-schema rowsets and always VARIANT\_FALSE for schema rowsets. |
| DBPROP\_BOOKMARKSKIPPED | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: Indicates whether the rowset allows IRowsetLocate::GetRowsAt, IRowsetScroll::GetApproximatePosition, or IRowsetFind::FindNextRow to continue if a bookmark row was deleted. For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE meaning DB\_E\_BADBOOKMARK is returned if a bookmark row is deleted. |
| DBPROP\_BOOKMARKTYPE | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_BMK\_NUMERIC  Description: The bookmark type. The Advantage OLE DB Provider implements numeric bookmarks only. An Advantage OLE DB Provider bookmark is 32-bit unsigned integer, type DBTYPE\_UI4. |
| DBPROP\_CACHEDEFERRED | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: Cache Deferred Columns. For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE because the value of a deferred column is not cached, and multiple calls to IRowset::GetData for the column can return different values. |
| DBPROP\_CANFETCHBACKWARDS | Type: VT\_BOOL  Typical R/W: Read/Write  Default: VARIANT\_FALSE  Description: Indicates whether the rowset can fetch backward. The Advantage OLE DB Provider supports backward fetching in non-sequential rowsets if this property is set to VARIANT\_TRUE. The Advantage OLE DB Provider supports high performance bi-directional recordsets. In cases where the recordset will only be read through in one direction, it is possible to get even higher performance by using a forward-only cursor. If both this property and DBPROP\_CANSCROLLBACKWARDS are set to FALSE, then the recordset is assumed to be forward-only, and the Advantage OLE DB provider will use an aggressive read-ahead record caching scheme that can reduce network traffic and improve performance. See [Read-Ahead Record Caching](master_read_ahead_record_caching.htm) for more information. |
| DBPROP\_CANHOLDROWS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: Whether the provider can hold rows. For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE because the consumer can retrieve more rows or change the next fetch position, while holding previously fetched rows. |
| DBPROP\_CANSCROLLBACKWARDS | Type: VT\_BOOL  Typical R/W: Read/Write  Default: VARIANT\_FALSE  Description: Indicates whether the rowset can scroll backward. The Advantage OLE DB Provider supports backward scrolling in non-sequential rowsets if this property is set to VARIANT\_TRUE. The Advantage OLE DB Provider supports high performance bi-directional recordsets. In cases where the recordset will only be read through in one direction, it is possible to get even higher performance by using a forward-only cursor. If both this property and DBPROP\_CANFETCHBACKWARDS are set to FALSE, then the recordset is assumed to be forward-only, and the Advantage OLE DB provider will use an aggressive read-ahead record caching scheme that can reduce network traffic and improve performance. See [Read-Ahead Record Caching](master_read_ahead_record_caching.htm) for more information. |
| DBPROP\_CHANGEINSERTEDROWS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: Whether inserted rows can be updated. For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE because inserted rows can be updated and deleted. |
| DBPROP\_COLUMNRESTRICT | Type: VT\_BOOL  Typical R/W: Read-only  Description: Whether access rights are restricted on a column-by-column basis. For the Advantage OLE DB Provider, this value is VARIANT\_TRUE if the rowset is an ADT table than contains an AutoIncrement column because AutoIncrement columns cannot be updated. This value is VARIANT\_FALSE if the rowset is an ADT table than does not contain an AutoIncrement column or if the rowset is a DBF table. |
| DBPROP\_COMMANDTIMEOUT | Type: VT\_I4  Typical R/W: Read/Write  Default: 0  Description: The number of seconds before a command (SQL query) times out and is aborted. The Advantage OLE DB Provider supports timeouts on the ICommand::Execute method and will abort the SQL query after the number of seconds specified by this property if the SQL query has not already completed execution. The default value of 0 means there is no timeout associated with the query. |
| DBPROP\_COMMITPRESERVE | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The behavior of a rowset after a commit operation is determined by this property. With the Advantage OLE DB Provider, after committing a transaction, the rowset remains active. That is, it is possible to fetch new rows, update, delete, and insert rows, and so on. |
| DBPROP\_DEFERRED | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: When data in a column is fetched. For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE because the data in the column is fetched when the row containing it is fetched. |
| DBPROP\_DELAYSTORAGEOBJECTS | Type: VT\_BOOL  Typical R/W: Read-only  Description: Delay Storage Object Updates  Specifies whether changes to the storage object (BLOB) are delayed just like non-BLOB data when in delayed update mode. For the Advantage OLE DB Provider, this property is set to VARIANT\_FALSE meaning changes to BLOB data are immediately transmitted to the data source object. |
| DBPROP\_HIDDENCOLUMNS | Type: VT\_I4  Typical R/W: Read-only  Default: 0  Description: For the Advantage OLE DB Provider, this value is always zero because unique rows are not supported, so no hidden columns are needed to make rows unique. |
| DBPROP\_IAccessor  DBPROP\_IColumnsInfo  DBPROP\_IConvertType  DBPROP\_IRowset  DBPROP\_IRowsetInfo | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider supports these interfaces on all rowsets. |
| DBPROP\_IChapteredRowset  DBPROP\_IRowsetView | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider exposes the IRowsetView and IChapteredRowset interfaces for non-schema rowsets. |
| DBPROP\_IConnectionPointContainer | Type: VT\_BOOL  Typical R/W: Read/Write  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider supports the IConnectionPointContainer interface for non-schema rowsets. |
| DBPROP\_IRowsetChange  DBPROP\_IRowsetUpdate | Type: VT\_BOOL  Typical R/W: Read/Write  Default: VARIANT\_FALSE  Description: The Advantage OLE DB Provider supports the IRowsetChange and IRowsetUpdate interfaces for non-schema rowsets. A rowset created with DBPROP\_IRowsetChange equal to VARIANT\_TRUE exhibits immediate update mode behaviors. When DBPROP\_IRowsetUpdate is VARIANT\_TRUE, DBPROP\_IRowsetChange is also VARIANT\_TRUE. The rowset exhibits delayed update mode behavior for the current row. |
| DBPROP\_IRowsetIdentity | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider supports the IRowsetIdentity interface. If a rowset supports this interface, any two row handles representing the same underlying row will always reflect the same data and state. Consumers can call the IRowsetIdentity::IsSameRow method to compare two row handles to see whether they refer to the same row instance. |
| DBPROP\_IRowsetIndex  DBPROP\_IRowsetCurrentIndex | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider supports the IRowsetIndex and IRowsetCurrentIndex interfaces for non-schema rowsets. Advantage supports getting and setting the current index order, seeking within an index order, and setting a range on an index order. |
| DBPROP\_IRowsetLocate  DBPROP\_IRowsetScroll  DBPROP\_IRowsetExactScroll | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider can expose the IRowsetLocate and IRowsetScroll interfaces for non-schema rowsets. |
| DBPROP\_IRowsetRefresh | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider exposes the IRowsetRefresh interface for non-schema rowsets. |
| DBPROP\_ISequentialStream | Type: VT\_BOOL  Typical R/W: Read-only  Description: ISequentialStream interface  For the Advantage OLE DB Provider, this property is set to VARIANT\_TRUE meaning the rowset is capable of manipulating the contents of columns as a storage object supporting ISequentialStream. |
| DBPROP\_ISupportErrorInfo | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: The Advantage OLE DB Provider exposes the ISupportErrorInfo interface on non-schema rowsets. |
| DBPROP\_IColumnsRowset | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE for rowsets opened through IOpenRowset, VARIANT\_FALSE for rowsets opened through ICommand.  Description: The Advantage OLE DB Provider supports this interface on rowsets opened through IOpenRowset::OpenRowset (rowsets opened with adCmdTableDirect in ADO). It is not supported on rowsets created through command objects (ICommand::Execute). |
| DBPROP\_IMMOBILEROWS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE, which means if the rowset is ordered, inserted rows appear in the rowset's proper order. If the rowset is not ordered, the inserted row appears at the end. If IRowsetChange::SetData changes a column that is used to order the rowset, the row is moved. (If the rowset is not ordered, the position of the row is not changed.) |
| DBPROP\_LITERALBOOKMARKS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE, which means that bookmarks can be compared literally. That is, they can be compared as a sequence of bytes. |
| DBPROP\_LITERALIDENTITY | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE, which means the consumer can perform a binary comparison of two row handles to determine whether they point to the same row. |
| DBPROP\_LOCKMODE | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_LM\_SINGLEROW  Description: For the Advantage OLE DB Provider, this value is always DBPROPVAL\_LM\_SINGLEROW, which means the provider uses the minimum level of locking necessary to ensure that changes successfully written to a single row returned by the most recent fetch will not fail due to a concurrency violation. Therefore, when using deferred update mode, IRowsetUpdate::Update will not fail due to a concurrency violation. The provider takes a lock on the row when IRowsetChange::SetData is first called on the row. The implications of DBPROPVAL\_LM\_SINGLEROW, and DBPROP\_LOCKMODE in general, are the same in both immediate and deferred update modes. |
| DBPROP\_MAXOPENROWS | Type: VT\_I4  Typical R/W: Read-only  Default: 0  Description: The Advantage OLE DB Provider does not limit the number of rows that can be active in rowsets. |
| DBPROP\_MAXPENDINGROWS | Type: VT\_I4  Typical R/W: Read-only  Default: 1  Description: The Advantage OLE DB Provider limits the number of rowset rows with changes pending to one. |
| DBPROP\_MAXROWS | Type: VT\_I4  Typical R/W: Read-only  Default: 0  Description: The Advantage OLE DB Provider does not limit the number of rows in a rowset. |
| DBPROP\_NOTIFICATIONGRANULARITY | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_NT\_MULTIPLEROWS  Description: For methods that operate on multiple rows, the Advantage OLE DB Provider calls IRowsetNotify::OnRowChange once for all rows that succeed and once for all rows that fail. |
| DBPROP\_NOTIFICATIONPHASES | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_NP\_OKTODO | DBPROPVAL\_NP\_ABOUTTODO | DBPROPVAL\_NP\_SYNCHAFTER | DBPROPVAL\_NP\_FAILEDTODO | DBPROPVAL\_NP\_DIDEVENT  Description: The Advantage OLE DB Provider supports all notification phases. |
| DBPROP\_NOTIFYCOLUMNSET  DBPROP\_NOTIFYROWDELETE  DBPROP\_NOTIFYROWFIRSTCHANGE  DBPROP\_NOTIFYROWINSERT  DBPROP\_NOTIFYROWRESYNCH  DBPROP\_NOTIFYROWSETCHANGED  DBPROP\_NOTIFYROWSETFETCHPOSITIONCHANGE  DBPROP\_NOTIFYROWSETRELEASE  DBPROP\_NOTIFYROWUNDOCHANGE  DBPROP\_NOTIFYROWUNDODELETE  DBPROP\_NOTIFYROWUNDOINSERT  DBPROP\_NOTIFYROWUPDATE | Type: VT\_I4  Typical R/W: Read-only  Default: DBPROPVAL\_NP\_OKTODO | DBPROPVAL\_NP\_ABOUTTODO  Description: The Advantage OLE DB Provider supports cancellation at the DBPROPVAL\_NP\_OKTODO and DBPROPVAL\_NP\_ABOUTTODO phases for all events. |
| DBPROP\_ORDEREDBOOKMARKS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE, which means that bookmarks can be compared only for equality. |
| DBPROP\_OTHERINSERT  DBPROP\_OTHERUPDATEDELETE  DBPROP\_OWNINSERT  DBPROP\_OWNUPDATEDELETE | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE for rowsets opened via IOpenRowset which means rowsets can see our and others updates, inserts, and deletes. For rowsets opened via the command object, the value will depend upon whether a dynamic or static cursor is returned. |
| DBPROP\_QUICKRESTART | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE which means IRowset::RestartPosition is relatively quick to execute. |
| DBPROP\_REENTRANTEVENTS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: The Advantage OLE DB Provider does not support reentrancy during notifications. |
| DBPROP\_REMOVEDELETED | Type: VT\_BOOL  Typical R/W: Read-only  Description: The Advantage OLE DB Provider alters the value of the property based on the table type being used and the ShowDeleted setting for DBF tables. When the rowset is an ADT table, this value will be VARIANT\_TRUE. When the rowset is a DBF table, and the ShowDeleted setting is FALSE, this value will be VARIANT\_TRUE. When the rowset is a DBF table, and the ShowDeleted setting is TRUE, this value will be VARIANT\_FALSE. |
| DBPROP\_REPORTMULTIPLECHANGES | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: For the Advantage OLE DB Provider, this value is always VARIANT\_FALSE, which means an update or delete always affects a single row. |
| DBPROP\_RETURNPENDINGINSERTS | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: When a method that fetches rows is called, the Advantage OLE DB Provider does not return pending insert rows. |
| DBPROP\_ROWRESTRICT | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_FALSE  Description: The Advantage OLE DB Provider rowsets do not support access rights based on the row. If the IRowsetChange interface is exposed on a rowset, the SetData method can be called by the consumer. |
| DBPROP\_ROWTHREADMODEL | Type: VT\_BOOL  Typical R/W: Read-only  Default: DBPROPVAL\_RT\_FREETHREAD  Description: A bitmask specifying the threading models supported by the rowset. For the Advantage OLE DB Provider, this value is always DBPROPVAL\_RT\_FREETHREAD. |
| DBPROP\_STRONGIDENTITY | Type: VT\_BOOL  Typical R/W: Read-only  Default: VARIANT\_TRUE  Description: Strong row identity. For the Advantage OLE DB Provider, this value is always VARIANT\_TRUE because the handles of newly inserted rows can be compared as specified by DBPROP\_LITERALIDENTITY. |
| DBPROP\_UNIQUEROWS | Type: VT\_BOOL  Typical R/W: Read-only  Description: Whether rows in the rowset may or may not be uniquely identified by their column values. For the Advantage OLE DB Provider, this value is VARIANT\_TRUE if the rowset is an ADT or VFP (Visual FoxPro) table than contains an AutoIncrement column because rowsets with AutoIncrement columns are guaranteed to be unique. It is also TRUE if the table contains a RowVersion column. Other wise this value is VARIANT\_FALSE. |
| DBPROP\_UPDATABILITY | Type: VT\_I4  Typical R/W: Read/Write  Default: DBPROPVAL\_UP\_CHANGE | DBPROPVAL\_UP\_DELETE | DBPROPVAL\_UP\_INSERT  Description: The Advantage OLE DB Provider supports all DBPROP\_UPDATABILITY values. Setting DBPROP\_UPDATABILITY does not create a modifiable rowset. To make a rowset modifiable, set DBPROP\_IRowsetChange or DBPROP\_IRowsetUpdate. |