AdsDataAdapter.Update




Advantage Database Server 12  

AdsDataAdapter.Update

Advantage .NET Data Provider

|  |
| --- |
|  |

|  |  |  |  |  |
| --- | --- | --- | --- | --- |
| AdsDataAdapter.Update  Advantage .NET Data Provider |  |  | Feedback on: Advantage Database Server 12 - AdsDataAdapter.Update Advantage .NET Data Provider dotnet\_Adsdataadapter\_update Advantage .NET Data Provider > AdsDataAdapter Class > AdsDataAdapter Methods > AdsDataAdapter.Update / Dear Support Staff, |  |
| AdsDataAdapter.Update  Advantage .NET Data Provider |  |  |  |  |

Calls the respective INSERT, UPDATE, or DELETE statements for each inserted, updated, or deleted row in the DataSet.

The following overloaded methods are supported:

public int Update( DataRow[] dataRows );

 

public int Update( DataSet dataSet );

 

public int Update( DataTable dataTable );

 

public int Update( DataSet dataSet, string srcTable );

Remarks

The return value is the number of rows successfully updated.

When an application calls the Update method, the DataAdapter examines the RowState property, and executes the required INSERT, UPDATE, or DELETE statements iteratively for each row, based on the order of the indexes configured in the DataSet. For example, Update might execute a DELETE statement, followed by an INSERT statement, and then another DELETE statement, due to the ordering of the rows in the DataTable.

These statements are not performed as a batch process; each row is updated individually. An application can call the GetChanges method in situations where you must control the sequence of statement types (for example, INSERTs before UPDATEs). For more information, please refer to Microsofts documentation.

If INSERT, UPDATE, or DELETE statements have not been specified, the Update method generates an exception. However, if you set the SelectCommand property, you can create an [AdsCommandBuilder](dotnet_adscommandbuilder.htm) object to automatically generate SQL statements for single-table updates. Then, any additional SQL statements that you do not set are generated by the AdsCommandBuilder.

The Update method retrieves rows from the table listed in the first mapping before performing an update. The Update then refreshes the row using the value of the [AdsCommand.UpdatedRowSource](dotnet_adscommand_updatedrowsource.htm) property. Any additional rows returned are ignored.

After any data is loaded back into the DataSet, the [OnRowUpdated](dotnet_adsdataadapter_onrowupdated.htm) event is raised, allowing the user to inspect the reconciled DataSet row and any output parameters returned by the command. After a row updates successfully, the changes to that row are accepted.

When using Update, the order of execution is as follows:

|  |  |
| --- | --- |
| 1. | The values in the DataRow are moved to the parameter values. |

|  |  |
| --- | --- |
| 2. | The OnRowUpdating event is raised. |

|  |  |
| --- | --- |
| 3. | The command executes. |

|  |  |
| --- | --- |
| 4. | If the command is set to FirstReturnedRecord, then the first returned result is placed in the DataRow. |

|  |  |
| --- | --- |
| 5. | If there are output parameters, they are placed in the DataRow. |

|  |  |
| --- | --- |
| 6. | The OnRowUpdated event is raised. |

|  |  |
| --- | --- |
| 7. | AcceptChanges is called. |

Each command associated with the DataAdapter usually has a parameters collection associated with it. Parameters are mapped to the current row through the [AdsParameter.SourceColumn](dotnet_adsparameter_sourcecolumn.htm) and [AdsParameter.SourceVersion](dotnet_adsparameter_sourceversion.htm) properties of a .NET data provider's Parameter class. SourceColumn refers to a DataTable column that the DataAdapter references to obtain parameter values for the current row.

SourceColumn refers to the unmapped column name before any table mappings have been applied. If SourceColumn refers to a nonexistent column, the action taken depends on one of the following MissingMappingAction values.

|  |  |
| --- | --- |
| Enumeration Value | Action Taken |
| MissingMappingAction.Passthrough | Use the source column names and table names in the DataSet if no mapping is present. |
| MissingMappingAction.Ignore | A SystemException is generated. When the mappings are explicitly set, a missing mapping for an input parameter is usually the result of an error. |
| MissingMappingAction.Error | A SystemException is generated. |

The [AdsParameter.SourceColumn](dotnet_adsparameter_sourcecolumn.htm) property is also used to map the value for output or input/output parameters back to the DataSet. An exception is generated if it refers to a nonexistent column.

The [AdsParameter.SourceVersion](dotnet_adsparameter_sourceversion.htm) property determines whether to use the Original, Current, or Proposed version of the column value. This capability is often used to include original values in the WHERE clause of an UPDATE statement to check for optimistic concurrency violations.

If an error occurs while updating a row, an exception is thrown and execution of the update is discontinued. To continue the update operation without generating exceptions when an error is encountered, set the AdsDataAdapter.ContinueUpdateOnError property to True before calling Update. You may also respond to errors on a per-row basis within the RowUpdated event. To continue the update operation without generating an exception within the RowUpdated event, set the Status property of the RowUpdatedEventArgs to Continue.

See Also

[AdsCommandBuilder](dotnet_adscommandbuilder.htm)